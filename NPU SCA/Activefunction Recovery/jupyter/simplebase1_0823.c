/*
    This file is part of the ChipWhisperer Example Targets
    Copyright (C) 2012-2017 NewAE Technology Inc.

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

#include "hal.h"
#include <stdint.h>
#include <stdlib.h>
#include <string.h> // memset함수 
#include <math.h>  // expf함수 
#include "simpleserial.h"

#define INPUT 3		// 입력층 노드 개수 
#define HIDDEN 6	// 첫번째 은닉층 노드 개수 
#define OUTPUT 2	// 출력층 노드 개수 

// 입,출력 데이터 

// 입력 데이터 
float X[INPUT] = { 0.0 };  // ※ Setting ※

float Y[OUTPUT];	

// Weight ( ※ Setting ※ )
float WX[INPUT][HIDDEN]; // 입력층 - 은닉층(1) 가중치(Weight)  // 왜 INPUT + 1인가?
float WH[HIDDEN][OUTPUT]; // 은닉층(1) - 출력층 가중치(Weight)	

// Weight Sum
float WSX[HIDDEN]; // 입력값으로 계산한 은닉층(1)에 들어갈 가중합
float WSH[OUTPUT]; // 은닉층(1)의 출력값으로 계산한 출력층에 들어갈 가중합 

// Activefunction Result
float AFR[HIDDEN];


// Active Function Implement
// expf : float 입출력 exp 함수 -> 존재하지 않음  

// Sigmoid 
float sigmoid(float h)
{
	return (1 / (1 + exp((-1)*h)));
}

// tanhf : float 입출력 Tanh함수 
float tanh2(float h)
{
   return (2 / (1 + exp(-2 * h)) - 1);

}

// ReLU 
float relu(float h)
{
	return (h > 0 ? h : 0);
}

float Hardsigmoid(float h)
{
	return (h > 2.5 ? 1 : (h < -2.5 ? 0 : 0.2*h + 0.5));
}

float LeaklyReLU(float h)
{
	return (h > 0 ? h : 0.01*h);
}


float ELU(float h)
{
	return (h > 0 ? h : exp(h) - 1);
}


float Softplus(float h)
{
	return log(exp(h) + 1);
}


float Softsign(float h)
{
	return (h / (1 + fabs(h)));
}

float Swish(float h)
{
	return (1 / (1 + exp(-h))) * h;
}



// 선택 입력
int count = 0;
float in = -3; // 10 


float input[2000] = {
2.98 ,4.23 ,-1.09 ,-2.70 ,-2.50 ,3.98 ,-0.24 ,4.75 ,1.26 ,-0.71 ,-3.79 ,
3.26 ,2.56 ,-1.54 ,2.58 ,-4.60 ,-1.99 ,-3.85 ,0.54 ,-3.79 ,1.59 ,
0.10 ,1.39 ,-2.67 ,-1.48 ,-4.39 ,-4.96 ,1.26 ,-3.93 ,4.04 ,4.31 ,
-4.46 ,-3.23 ,-2.90 ,-3.07 ,-1.18 ,0.41 ,-2.09 ,0.21 ,0.28 ,0.36 ,
-1.81 ,1.01 ,-1.10 ,-3.26 ,0.29 ,2.33 ,-4.49 ,3.50 ,1.38 ,3.44 ,
-2.92 ,-3.40 ,-2.68 ,0.52 ,2.29 ,-0.97 ,0.14 ,4.09 ,1.49 ,4.99 ,
2.72 ,3.06 ,-2.34 ,-3.80 ,1.01 ,-4.91 ,-2.04 ,-3.62 ,0.34 ,-4.00 ,
0.12 ,-2.89 ,-2.06 ,4.15 ,-4.75 ,1.45 ,-4.32 ,-0.21 ,-2.21 ,2.61 ,
-3.00 ,-3.58 ,0.70 ,0.63 ,-4.36 ,-4.27 ,2.64 ,-4.72 ,4.46 ,-0.21 ,
1.34 ,-2.00 ,2.01 ,-0.28 ,2.47 ,-4.81 ,2.43 ,-1.20 ,-2.29 ,-2.52 ,
-3.34 ,-3.67 ,0.49 ,-1.69 ,-3.13 ,3.25 ,-4.50 ,-2.33 ,-1.20 ,-0.42 ,
-1.74 ,1.57 ,1.43 ,-1.45 ,-1.97 ,-3.75 ,1.69 ,-1.98 ,-3.70 ,2.79 ,
-1.97 ,-4.66 ,-3.35 ,-4.26 ,-1.86 ,2.67 ,4.08 ,-4.94 ,2.83 ,-1.96 ,
1.45 ,-2.15 ,1.99 ,-3.20 ,-0.08 ,-0.72 ,-0.58 ,4.29 ,-1.83 ,-4.28 ,
-3.73 ,-4.47 ,0.86 ,-3.21 ,1.93 ,4.50 ,1.52 ,-4.65 ,-3.70 ,4.87 ,
2.46 ,2.81 ,-0.83 ,2.30 ,-2.45 ,-2.88 ,-0.16 ,-3.28 ,-1.00 ,1.76 ,
-0.27 ,-3.34 ,-4.83 ,4.37 ,-4.40 ,-3.28 ,4.86 ,-1.11 ,-2.22 ,-1.13 ,
2.20 ,-4.13 ,-1.10 ,3.46 ,4.64 ,3.77 ,3.57 ,-3.73 ,-3.17 ,-1.91 ,
-4.50 ,-1.51 ,-0.74 ,-4.32 ,-0.50 ,3.98 ,4.59 ,2.07 ,-4.50 ,0.39 ,
-1.18 ,-1.33 ,-1.53 ,-4.17 ,2.50 ,-2.30 ,-0.76 ,-4.30 ,1.34 ,1.72 ,
4.70 ,-4.13 ,-4.71 ,4.93 ,4.39 ,-2.68 ,3.76 ,3.75 ,0.22 ,-0.29 ,
3.88 ,0.11 ,-1.58 ,4.78 ,-1.08 ,-0.84 ,-4.34 ,0.39 ,-4.64 ,1.54 ,
4.94 ,-3.08 ,0.28 ,-3.44 ,0.45 ,-0.47 ,-3.11 ,3.98 ,3.25 ,4.22 ,
-3.97 ,4.24 ,-3.77 ,2.56 ,-0.61 ,3.52 ,-2.60 ,4.13 ,-2.49 ,-2.95 ,
-1.97 ,2.48 ,4.10 ,-3.63 ,2.19 ,-1.15 ,-2.95 ,1.16 ,3.12 ,-3.97 ,
3.42 ,0.27 ,-2.37 ,3.26 ,2.46 ,0.84 ,0.37 ,0.13 ,-2.25 ,-1.28 ,
3.24 ,-0.75 ,-4.80 ,-2.48 ,-2.73 ,-0.98 ,-4.80 ,4.98 ,-4.96 ,-0.94 ,
0.30 ,1.40 ,4.75 ,3.35 ,2.14 ,-2.66 ,-1.91 ,-4.98 ,3.32 ,1.50 ,
-2.09 ,3.80 ,-3.40 ,1.26 ,2.79 ,-1.68 ,2.31 ,-1.19 ,0.73 ,2.82 ,
-2.29 ,-4.38 ,-1.05 ,-0.29 ,3.00 ,0.09 ,2.21 ,-4.59 ,2.16 ,1.97 ,
-4.19 ,-0.76 ,-3.88 ,-0.81 ,3.14 ,1.16 ,-0.34 ,-2.75 ,4.34 ,4.07 ,
0.84 ,4.61 ,-3.40 ,-3.35 ,-4.06 ,-1.46 ,0.99 ,-2.53 ,-3.59 ,0.69 ,
-2.68 ,-2.68 ,1.96 ,3.93 ,-2.94 ,0.99 ,-4.07 ,-2.16 ,2.57 ,0.23 ,
-4.34 ,2.64 ,-4.85 ,-1.73 ,2.39 ,2.96 ,4.81 ,0.36 ,1.52 ,-4.15 ,
-3.91 ,-1.24 ,-4.96 ,-4.90 ,-0.94 ,3.13 ,-3.26 ,-2.84 ,-4.72 ,2.54 ,
-2.52 ,-1.40 ,4.79 ,0.02 ,0.57 ,2.19 ,-1.59 ,3.23 ,-4.38 ,1.34 ,
-3.42 ,4.86 ,-1.86 ,-3.83 ,0.95 ,-1.04 ,3.35 ,-2.86 ,-3.62 ,-4.56 ,
-3.11 ,4.97 ,-1.83 ,-1.69 ,3.74 ,2.24 ,-1.50 ,1.85 ,3.03 ,-4.04 ,
2.86 ,0.07 ,-3.21 ,-0.73 ,0.03 ,1.84 ,-3.77 ,1.68 ,1.85 ,4.72 ,
1.58 ,-4.23 ,-0.37 ,-4.85 ,-1.99 ,1.07 ,2.50 ,-3.91 ,-1.67 ,3.56 ,
3.30 ,-0.73 ,3.63 ,-3.61 ,-3.17 ,1.13 ,2.61 ,-2.86 ,-1.37 ,2.58 ,
-2.40 ,-0.75 ,0.65 ,-2.43 ,1.79 ,-0.37 ,-3.99 ,-0.70 ,-2.45 ,2.99 ,
-0.70 ,-1.53 ,2.91 ,3.74 ,-3.43 ,-3.56 ,-4.82 ,3.02 ,1.55 ,0.92 ,
0.12 ,-1.31 ,-1.18 ,2.03 ,-1.63 ,-1.54 ,3.51 ,-0.68 ,2.47 ,1.12 ,
-3.48 ,-0.42 ,1.96 ,-2.06 ,-0.30 ,-2.75 ,-4.97 ,-1.54 ,1.78 ,4.52 ,
3.61 ,2.22 ,-2.08 ,-3.27 ,-0.65 ,-4.75 ,3.87 ,3.04 ,2.77 ,-0.20 ,
1.24 ,-4.42 ,-4.46 ,-3.59 ,-0.51 ,2.26 ,-3.55 ,-5.00 ,-1.69 ,2.52 ,
3.71 ,2.89 ,-0.25 ,-4.49 ,1.89 ,-1.60 ,0.78 ,-4.97 ,3.14 ,4.73 ,
4.16 ,-3.08 ,-1.20 ,-3.53 ,1.80 ,-4.55 ,-2.52 ,4.95 ,-4.22 ,-2.37 ,
0.93 ,4.69 ,-2.81 ,-4.71 ,2.08 ,-1.98 ,-4.82 ,1.31 ,1.96 ,1.95 ,
-3.45 ,1.26 ,-2.63 ,3.03 ,-0.77 ,-4.15 ,-0.86 ,3.56 ,-1.20 ,1.58 ,
1.70 ,-0.70 ,0.51 ,-0.18 ,-4.79 ,3.89 ,1.96 ,-4.71 ,-2.71 ,-0.64 ,
4.34 ,1.25 ,-4.23 ,1.99 ,-0.84 ,0.63 ,2.32 ,-0.57 ,-3.71 ,3.39 ,
-3.96 ,2.41 ,2.18 ,-1.95 ,-3.13 ,-0.47 ,-3.59 ,-1.09 ,4.20 ,4.62 ,
3.92 ,-4.31 ,-2.44 ,0.39 ,-2.94 ,-1.71 ,-3.59 ,-3.61 ,3.57 ,-2.15 ,
-4.42 ,-4.83 ,-4.07 ,-0.52 ,-2.30 ,-0.23 ,-3.38 ,-3.06 ,-4.30 ,-1.54 ,
-3.46 ,2.76 ,3.00 ,-1.16 ,4.36 ,1.88 ,-4.84 ,-2.21 ,1.58 ,-4.17 ,
-0.93 ,-1.75 ,-0.62 ,3.71 ,3.77 ,3.67 ,-4.97 ,-1.44 ,-4.22 ,-3.06 ,
1.50 ,2.24 ,-0.17 ,-0.73 ,-3.55 ,-0.96 ,0.29 ,-2.84 ,3.18 ,-3.99 ,
0.57 ,3.06 ,0.19 ,4.83 ,-4.08 ,1.91 ,-3.56 ,0.91 ,1.45 ,-4.91 ,
-2.72 ,3.36 ,-2.77 ,-4.00 ,1.95 ,-4.36 ,-2.59 ,-3.33 ,4.49 ,-3.10 ,
-1.17 ,3.96 ,-2.45 ,-4.28 ,-0.17 ,4.85 ,0.63 ,-3.31 ,-1.35 ,1.52 ,
-0.59 ,-1.18 ,3.84 ,-1.36 ,-2.40 ,-3.25 ,-0.65 ,-3.87 ,-1.32 ,2.55 ,
-3.83 ,1.64 ,4.89 ,-1.70 ,0.92 ,3.83 ,1.50 ,-3.77 ,-0.97 ,-2.91 ,
0.52 ,-4.81 ,-0.80 ,-0.29 ,0.46 ,3.05 ,0.55 ,-1.93 ,3.72 ,2.05 ,
4.91 ,-1.52 ,-1.69 ,-4.39 ,1.35 ,-4.79 ,-3.12 ,-4.88 ,2.15 ,-2.99 ,
-4.50 ,0.65 ,-1.24 ,-3.24 ,-3.66 ,-4.17 ,-4.42 ,-0.21 ,3.12 ,-1.60 ,
1.47 ,-2.73 ,-2.95 ,0.92 ,-4.61 ,0.18 ,-1.36 ,2.71 ,-0.75 ,-3.05 ,
-2.90 ,-2.44 ,-3.89 ,-4.24 ,4.30 ,3.02 ,3.00 ,4.66 ,2.23 ,2.77 ,
3.58 ,2.76 ,-3.44 ,1.04 ,-0.10 ,-2.83 ,-3.13 ,-4.34 ,-3.56 ,2.98 ,
-3.93 ,2.56 ,-2.79 ,-3.03 ,-1.45 ,-3.92 ,2.97 ,2.45 ,1.91 ,2.35 ,
1.11 ,-0.30 ,-2.89 ,4.03 ,-2.62 ,-4.52 ,1.48 ,-0.28 ,-3.44 ,-0.92 ,
-4.38 ,-0.81 ,2.72 ,0.97 ,-2.63 ,-4.00 ,0.94 ,-2.97 ,-3.28 ,4.16 ,
1.94 ,-4.83 ,-0.70 ,2.82 ,2.13 ,-2.19 ,-2.74 ,3.83 ,-0.99 ,-3.74 ,
-0.22 ,-1.12 ,3.67 ,-3.62 ,-3.81 ,-0.45 ,-3.99 ,-2.58 ,-1.89 ,-1.98 ,
0.49 ,-4.83 ,-4.88 ,-1.59 ,-0.91 ,0.20 ,1.45 ,4.25 ,1.13 ,-2.14 ,
3.31 ,-0.53 ,4.80 ,4.74 ,-4.08 ,2.50 ,-1.09 ,1.59 ,-1.24 ,0.15 ,
3.76 ,3.50 ,4.24 ,-4.39 ,2.34 ,-2.76 ,0.10 ,0.60 ,-0.93 ,4.07 ,
-2.31 ,2.24 ,0.03 ,-0.18 ,-0.68 ,-4.41 ,-0.76 ,4.53 ,-3.54 ,3.75 ,
-0.71 ,3.08 ,-2.04 ,0.86 ,-1.84 ,1.08 ,-1.25 ,-3.09 ,-1.86 ,1.99 ,
0.20 ,3.83 ,-1.01 ,-1.26 ,-1.36 ,-2.12 ,2.12 ,1.64 ,-4.86 ,0.95 ,
2.37 ,3.41 ,2.34 ,3.14 ,-1.67 ,-3.74 ,0.13 ,-4.06 ,-4.32 ,4.60 ,
-1.30 ,4.42 ,2.13 ,-3.71 ,1.93 ,2.12 ,-2.27 ,-2.65 ,4.74 ,2.26 ,
-4.47 ,0.07 ,-4.51 ,3.75 ,3.52 ,3.12 ,3.29 ,4.69 ,-1.33 ,1.87 ,
0.92 ,-4.49 ,-2.29 ,-4.50 ,3.87 ,0.70 ,3.65 ,0.64 ,-2.76 ,4.77 ,
-0.33 ,-3.48 ,-4.76 ,-0.13 ,-4.05 ,-4.28 ,3.19 ,0.97 ,2.44 ,-3.32 ,
3.34 ,2.28 ,1.89 ,-2.89 ,-4.36 ,-2.84 ,-3.42 ,3.28 ,-4.60 ,-2.98 ,
-2.78 ,2.09 ,-2.43 ,-0.76 ,1.13 ,-4.09 ,3.80 ,4.11 ,-3.38 ,-3.44 ,
-3.57 ,2.95 ,-3.25 ,2.98 ,4.53 ,-1.54 ,0.47 ,4.24 ,1.30 ,2.40 ,
-2.82 ,-2.94 ,-4.64 ,1.63 ,0.41 ,-3.78 ,3.92 ,-1.42 ,-1.08 ,-0.36 ,
-2.57 ,-4.94 ,0.90 ,-3.34 ,-1.43 ,-2.83 ,-2.57 ,1.21 ,-2.19 ,-0.99 ,
-4.28 ,-0.55 ,-0.47 ,-3.02 ,-4.37 ,2.14 ,-3.58 ,-3.32 ,2.22 ,-3.40 ,
-3.62 ,-2.98 ,1.11 ,-3.55 ,1.33 ,-3.07 ,-0.61 ,-4.82 ,-3.07 ,3.69 ,
-4.45 ,-3.58 ,-2.30 ,2.70 ,-4.80 ,-0.98 ,-2.07 ,2.70 ,-2.63 ,-0.98 ,
1.25 ,3.02 ,4.60 ,-0.59 ,3.41 ,-1.05 ,-0.68 ,-1.28 ,3.22 ,1.35 ,
2.86 ,-3.99 ,1.87 ,-4.52 ,2.12 ,2.11 ,-1.31 ,4.03 ,-2.23 ,1.92 ,
0.10 ,-1.78 ,4.69 ,3.32 ,-0.25 ,-1.43 ,3.48 ,-4.44 ,2.97 ,-0.70 ,
3.21 ,-2.02 ,-3.58 ,-2.56 ,3.68 ,-3.30 ,-1.77 ,-4.54 ,-0.44 ,2.95 ,
-0.30 ,0.15 ,-2.53 ,-3.49 ,-3.79 ,-3.18 ,2.38 ,4.03 ,4.59 ,-4.76 ,
-1.45 ,3.50 ,3.86 ,-2.02 ,1.60 ,3.83 ,1.29 ,4.98 ,-1.30
};



//******************************************************************************************************//

uint8_t get_key(uint8_t* k)
{
	// Load key here
	return 0x00;
}

#if SS_VER == SS_VER_2_0
uint8_t get_pt(uint8_t cmd, uint8_t scmd, uint8_t len, uint8_t* pt)
#else
uint8_t get_pt(uint8_t* pt) // char형값 16개 -> [0~4] 4개만 사용
#endif

{
	/**********************************
	* Start user-specific code here. */
    
    char *p;
    float temp;
#if 0    
    
    // 입력층 
    X[0] = input[count];
    X[1] = input[count+1];
    X[2] = input[count+2];
    count+=3;
#endif
   
    float y;


    int i, j;
	float sum = 0;

	// Weight 설정 
    WX[0][0] = -2.464;
    WX[0][1] = -4.633;
    WX[0][2] = -0.948;
    WX[0][3] = -4.241;
    WX[0][4] = 0.847;
    WX[0][5] = 1.477;
    WX[1][0] = -3.501;
    WX[1][1] = 1.613;
    WX[1][2] = 1.073;
    WX[1][3] = 0.331;
    WX[1][4] = 4.349;
    WX[1][5] = 4.728;
    WX[2][0] = 3.537;
    WX[2][1] = 0.215;
    WX[2][2] = -3.727;
    WX[2][3] = -0.018;
    WX[2][4] = -3.035;
    WX[2][5] = -4.727;


    WH[0][0] = 3.746;
    WH[0][1] = -4.071;
    WH[1][0] = 4.049;
    WH[1][1] = -1.419;
    WH[2][0] = 3.681;
    WH[2][1] = 2.544;
    WH[3][0] = -1.990;
    WH[3][1] = -4.119;
    WH[4][0] = 4.102;
    WH[4][1] = -2.527;
    WH[5][0] = 1.181;
    WH[5][1] = -3.696;

   
	// 초기화 
	memset(WSX, 0, sizeof(WSX));
	memset(WSH, 0, sizeof(WSH));

    
    trigger_high();
    //y = relu(input[count]);
    //y = sigmoid(input[count]);
    //y = tanh2(input[count]);
    //y = Hardsigmoid(input[count]);
    //y = LeaklyReLU(input[count]);
    //y = ELU(input[count]);
    //y = Softplus(input[count]);
    //y = Softsign(input[count]);
    //y = Swish(input[count]);
    
     //y = relu(in);
    //y = sigmoid(in);
    //y = tanh2(in);
    //y = Hardsigmoid(in);
    //y = LeaklyReLU(in);
    //y = ELU(in);
    //y = Softplus(in);
    //y = Softsign(in);
    y = Swish(in);
    
    trigger_low();
    X[0] = in;
    in+=0.01; 
    //count += 1;
    
    
#if 0
    
    //trigger_high();


	// 가중합 + 활성함수 
	for (i = 0; i < 1; i++) 
	{
		for (j = 0; j < INPUT; j++)  
		{
			WSX[i] += X[j] * WX[j][i];
		}
            trigger_high();
		//AFR[i] = sigmoid(WSX[i]);
		//AFR[i] = tanh2(WSX[i]);
		AFR[i] = relu(WSX[i]);
        //AFR[i] = Hardsigmoid(WSX[i]);
        //AFR[i] = LeaklyReLU(WSX[i]);
        //AFR[i] = ELU(WSX[i]);
        //AFR[i] = Softplus(WSX[i]);
        //AFR[i] = Softsign(WSX[i]);
        //AFR[i] = Swish(WSX[i]);
        trigger_low();
        
        #if 0
        if(i == 0 ) // 첫번째 노드의 활성함수 출력값 담기 
        {
            p = &temp;
            temp = tanh2(WSX[i]);
            pt[4] = p[0];
            pt[5] = p[1];
            pt[6] = p[2];
            pt[7] = p[3];
            
            temp = sigmoid(WSX[i]);
            pt[8] = p[0];
            pt[9] = p[1];
            pt[10] = p[2];
            pt[11] = p[3];
        }
        #endif
	}



    
    #if 0
	// 가중합 + softmax exp연산 
	for (i = 0; i < OUTPUT; i++)
	{
		for (j = 0; j < HIDDEN; j++) 
		{
			WSH[i] += AFR[j] * WH[j][i];
		}
		Y[i] = exp(WSH[i]); // 분자 
		sum += Y[i];
	}

	
	for (i = 0; i < OUTPUT; i++) 
	{
		Y[i] /= sum; 
	}
    
    #endif

    

//trigger_low();
	//16 hex bytes held in 'pt' were sent
	//from the computer. Store your response
	//back into 'pt', which will send 16 bytes
	//back to computer. Can ignore of course if
	//not needed
	
	
   
    #endif 
    
    // 입력값 3개를 더해서 활성함수 입력 만들기 
    p = X;
    pt[0] = p[0];
    pt[1] = p[1];
    pt[2] = p[2];
    pt[3] = p[3];
    
//     pt[4] = p[4];
//     pt[5] = p[5];
//     pt[6] = p[6];
//     pt[7] = p[7];
    
//     pt[8] = p[8];
//     pt[9] = p[9];
//     pt[10] = p[10];
//     pt[11] = p[11];
    
//     X[0] = X[0] + X[1] + X[2];
//     pt[12] = p[0];
//     pt[13] = p[1];
//     pt[14] = p[2];
//     pt[15] = p[3];

    
    
    
    /*
    // 출력값 1개 -> softmax라서 나머지 1개 알 수 있음 
	p = Y;
    pt[12] = p[0];
    pt[13] = p[1];
    pt[14] = p[2];
    pt[15] = p[3];
    */
    
    
    
	/* End user-specific code here. *
	********************************/
	simpleserial_put('r', 16, pt);
	return 0x00;
}

uint8_t reset(uint8_t* x)
{
	// Reset key here if needed
	return 0x00;
}


int main(void)
{
    platform_init();
	init_uart();	
	trigger_setup();
	
 	/* Uncomment this to get a HELLO message for debug */
	/*
	putch('h');
	putch('e');
	putch('l');
	putch('l');
	putch('o');
	putch('\n');
	*/
		
	simpleserial_init();		
	simpleserial_addcmd('p', 16, get_pt);
#if SS_VER != SS_VER_2_0
	simpleserial_addcmd('k', 16, get_key);
	simpleserial_addcmd('x', 0, reset);
#endif
	while(1)
		simpleserial_get();
}
